<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>SVGs Plots — svg_nSD • BatchSVG</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SVGs Plots — svg_nSD"><meta name="description" content="This function generates visualizations to assess the impact
of batch effects on spatially variable genes (SVGs) by analyzing changes
in deviance and rank. The function bins the deviations into normalized
standard deviation (nSD) intervals and creates histograms and scatter
plots to illustrate the distribution of batch effects."><meta property="og:description" content="This function generates visualizations to assess the impact
of batch effects on spatially variable genes (SVGs) by analyzing changes
in deviance and rank. The function bins the deviations into normalized
standard deviation (nSD) intervals and creates histograms and scatter
plots to illustrate the distribution of batch effects."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BatchSVG</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/spe.html">Find Batch-biased Features in SVGs</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/christinehou11/BatchSVG/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>SVGs Plots</h1>
      <small class="dont-index">Source: <a href="https://github.com/christinehou11/BatchSVG/blob/main/R/svg_nSD.R" class="external-link"><code>R/svg_nSD.R</code></a></small>
      <div class="d-none name"><code>svg_nSD.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates visualizations to assess the impact
of batch effects on spatially variable genes (SVGs) by analyzing changes
in deviance and rank. The function bins the deviations into normalized
standard deviation (nSD) intervals and creates histograms and scatter
plots to illustrate the distribution of batch effects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">svg_nSD</span><span class="op">(</span><span class="va">list_batch_df</span>, <span class="va">sd_interval_dev</span>, <span class="va">sd_interval_rank</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-list-batch-df">list_batch_df<a class="anchor" aria-label="anchor" href="#arg-list-batch-df"></a></dt>
<dd><p>A named list of data frames, where each data frame
corresponds to a batch effect and contains columns with deviance and
rank differences.</p></dd>


<dt id="arg-sd-interval-dev">sd_interval_dev<a class="anchor" aria-label="anchor" href="#arg-sd-interval-dev"></a></dt>
<dd><p>A numeric vector specifying the
interval widths for standard deviation bins for each batch when analyzing
the relative change in deviance. The order of values must correspond to
the order of batches in <code>list_batch_df</code> .
If a single value is provided, it is applied to all batches; otherwise,
it must have the same length as <code>list_batch_df</code>.</p></dd>


<dt id="arg-sd-interval-rank">sd_interval_rank<a class="anchor" aria-label="anchor" href="#arg-sd-interval-rank"></a></dt>
<dd><p><code>vector</code>: A numeric vector specifying the
interval widths for standard deviation bins when analyzing rank
differences. The order of values must correspond to the order of batches
in <code>list_batch_df</code>.
If a single value is provided, it is applied to all batches; otherwise,
it must have the same length as <code>list_batch_df</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A combined <code>ggplot</code> object containing:</p><ul><li><p><strong>Deviance Plots</strong>:</p><ul><li><p>Histogram of deviance differences across SVGs, colored by
nSD intervals.</p></li>
<li><p>Scatter plot comparing deviance values before and after
batch correction.</p></li>
</ul></li>
<li><p><strong>Rank Plots</strong>:</p><ul><li><p>Histogram of rank differences across SVGs, colored by
nSD intervals.</p></li>
<li><p>Scatter plot comparing ranks before and after batch
correction.</p></li>
</ul></li>
</ul><p>The function arranges plots for each batch in a grid format for
easy comparison.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ExperimentHub</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">ehub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ExperimentHub/man/ExperimentHub-class.html" class="external-link">ExperimentHub</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="va">ehub</span><span class="op">[[</span><span class="st">"EH9605"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">fix_order</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">)</span>, <span class="va">slide</span>, <span class="va">array</span>, <span class="va">brnum</span>, <span class="va">sample_id</span>, </span></span>
<span class="r-in"><span>    <span class="va">position</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">slide</span>, <span class="va">array</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sub4</span> <span class="op">&lt;-</span> <span class="va">fix_order</span><span class="op">$</span><span class="va">sample_id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>,<span class="fl">16</span>, <span class="fl">20</span>,<span class="fl">21</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">spe_sub4</span> <span class="op">&lt;-</span> <span class="va">spe</span><span class="op">[</span>,<span class="va">spe</span><span class="op">$</span><span class="va">sample_id</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">sub4</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">svgs_sub4</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"svgs_sub4.csv"</span>,package <span class="op">=</span> <span class="st">"BatchSVG"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    row.names <span class="op">=</span> <span class="fl">1</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spe_sub4</span> <span class="op">&lt;-</span> <span class="va">spe_sub4</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">spe_sub4</span><span class="op">)</span><span class="op">$</span><span class="va">gene_id</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">svgs_sub4</span><span class="op">$</span><span class="va">gene_id</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">spe_sub4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">spe_sub4</span><span class="op">)</span><span class="op">$</span><span class="va">gene_id</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SVGs</span> <span class="op">&lt;-</span> <span class="va">svgs_sub4</span><span class="op">$</span><span class="va">gene_id</span></span></span>
<span class="r-in"><span><span class="va">list_batch_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="featureSelect.html">featureSelect</a></span><span class="op">(</span>input <span class="op">=</span> <span class="va">spe_sub4</span>, </span></span>
<span class="r-in"><span>   batch_effects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample_id"</span>, <span class="st">"sex"</span><span class="op">)</span>, VGs <span class="op">=</span> <span class="va">SVGs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu">svg_nSD</span><span class="op">(</span>list_batch_df <span class="op">=</span> <span class="va">list_batch_df</span>, </span></span>
<span class="r-in"><span>   sd_interval_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span>, sd_interval_rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christine Hou, Jacqui Thompson, Stephanie C. Hicks.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

