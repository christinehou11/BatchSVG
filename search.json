[{"path":[]},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported community leaders responsible enforcement chris2018hou@gmail.com. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.1, available https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Community Impact Guidelines inspired [Mozilla’s code conduct enforcement ladder][https://github.com/mozilla/inclusion]. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to BatchSVG","title":"Contributing to BatchSVG","text":"outlines propose change BatchSVG. detailed discussion contributing tidyverse packages, please see development contributing guide code review principles.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to BatchSVG","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ’ll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":"bigger-changes","dir":"","previous_headings":"","what":"Bigger changes","title":"Contributing to BatchSVG","text":"want make bigger change, ’s good idea first file issue make sure someone team agrees ’s needed. ’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed). See guide create great issue advice.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Bigger changes","what":"Pull request process","title":"Contributing to BatchSVG","text":"Fork package clone onto computer. haven’t done , recommend using usethis::create_from_github(\"christinehou11/BatchSVG\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn’t pass cleanly, ’s good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e. just first header). Follow style described https://style.tidyverse.org/news.html.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Bigger changes","what":"Code style","title":"Contributing to BatchSVG","text":"New code follow tidyverse style guide. can use styler package apply styles, please don’t restyle code nothing PR. use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to BatchSVG","text":"Please note BatchSVG project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/SUPPORT.html","id":null,"dir":"","previous_headings":"","what":"Getting help with BatchSVG","title":"Getting help with BatchSVG","text":"Thank using BatchSVG! filing issue, things know make process smooth possible parties.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/SUPPORT.html","id":"make-a-reprex","dir":"","previous_headings":"","what":"Make a reprex","title":"Getting help with BatchSVG","text":"Start making minimally reproducible example, also known ‘reprex’. may use reprex R package create one, though necessary help. make R-question-asking endeavors easier. Learning use takes 5 10 minutes. tips make minimally reproducible example, see StackOverflow link.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/SUPPORT.html","id":"where-to-post-it","dir":"","previous_headings":"","what":"Where to post it?","title":"Getting help with BatchSVG","text":"Bioconductor help web page gives overview places may help answer question. Bioconductor software related questions, bug reports feature requests, addressed appropriate Bioconductor/BatchSVG GitHub repository. Follow bug report feature request templates GitHub. package GitHub repository, see next bullet point. Bioconductor software usage questions addressed Bioconductor Support Website. Make sure use appropriate package tag, otherwise package authors get notification. General R questions can posed StackOverflow RStudio Community website especially pertain tidyverse RStudio GUI related products.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/SUPPORT.html","id":"issues-or-feature-requests","dir":"","previous_headings":"","what":"Issues or Feature Requests","title":"Getting help with BatchSVG","text":"opening new issue feature request, sure search issues pull requests ensure one already exist implemented development version. Note. can remove :open search term issues page search open closed issues. See link learn modifying search.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/SUPPORT.html","id":"what-happens-next","dir":"","previous_headings":"","what":"What happens next?","title":"Getting help with BatchSVG","text":"Bioconductor maintainers limited resources strive responsive possible. Please forget tag appropriate maintainer issue GitHub username (e.g., @username). order make easy possible Bioconductor core developers remediate issue. Provide accurate, brief, reproducible report outlined issue templates. Thank trusting Bioconductor.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Find Batch-biased Features in SVGs","text":"BatchSVG R/Bioconductor package spatial transcriptomics data quality control (QC). feature-based QC method, package provides functions identify biased features associated batch effect(s) (e.g. sample, slide, sex) spatially variable genes (SVGs) using binomial deviance model, aiming develop downstream clustering performances remove technical noises caused batch effects. package works SpatialExperiment objects.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Find Batch-biased Features in SVGs","text":"(accepted Bioconductor). Install development version GitHub.","code":"if (!requireNamespace(\"BiocManager\")) {     install.packages(\"BiocManager\") } BiocManager::install(\"BatchSVG\") remotes::install(\"christinehou11/BatchSVG\")"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"biased-feature-identification","dir":"Articles","previous_headings":"","what":"Biased Feature Identification","title":"Find Batch-biased Features in SVGs","text":"section, include standard workflow using BatchSVG show method help detect visualize biased features SVGs.","code":"library(BatchSVG) library(spatialLIBD) library(cowplot)"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"data","dir":"Articles","previous_headings":"Biased Feature Identification","what":"Data","title":"Find Batch-biased Features in SVGs","text":"use `spatially-resolved transcriptomics (SRT) dataset spatialLIBD package. use spatially variable genes set generated. result generated nnSVG package.","code":"spatialLIBD_spe <- fetch_data(type = \"spe\") spatialLIBD_spe class: SpatialExperiment  dim: 33538 47681  metadata(0): assays(2): counts logcounts rownames(33538): ENSG00000243485 ENSG00000237613 ... ENSG00000277475   ENSG00000268674 rowData names(9): source type ... gene_search is_top_hvg colnames(47681): AAACAACGAATAGTTC-1 AAACAAGTATCTCCCA-1 ...   TTGTTTCCATACAACT-1 TTGTTTGTGTAAATTC-1 colData names(69): sample_id Cluster ... array_row array_col reducedDimNames(6): PCA TSNE_perplexity50 ... TSNE_perplexity80   UMAP_neighbors15 mainExpName: NULL altExpNames(0): spatialCoords names(2) : pxl_col_in_fullres pxl_row_in_fullres imgData names(4): sample_id image_id data scaleFactor libd_nnsvgs <- read.csv(     system.file(\"extdata\",\"libd-all_nnSVG_p-05-features-df.csv\",         package = \"BatchSVG\"),     row.names = 1, check.names = FALSE)"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"perform-feature-selection-using-featureselect","dir":"Articles","previous_headings":"Biased Feature Identification","what":"Perform Feature Selection using featureSelect()","title":"Find Batch-biased Features in SVGs","text":"perform feature selection subset spatial transcriptomics data (input) using predefined set spatially variable genes (VGs). Specifically, compute number standard deviations relative change deviance (nSD_dev_{batch effect}) rank difference (nSD_rank_{batch effect}) adjusting batch effects. featureSelect() function enables feature selection accounting multiple batch effects. returns list data frames, batch effect associated corresponding data frame containing key results, including: Relative change deviance batch effect adjustment Rank differences batch-corrected uncorrected results Number standard deviations (nSD) relative change deviance rank difference use example applying featureSelect() sample dataset adjusting batch effect subject.","code":"list_batch_df <- featureSelect(input = spatialLIBD_spe,      batch_effect = \"subject\", VGs = libd_nnsvgs$gene_id) Running feature selection without batch... Batch Effect: subject Running feature selection without batch... Calculating deviance and rank difference... class(list_batch_df) [1] \"list\" head(list_batch_df$subject)           gene_id gene_name dev_default rank_default dev_subject rank_subject 1 ENSG00000187608     ISG15    43591.43         1151    43304.39         1157 2 ENSG00000131584     ACAP3    39115.97         1498    38826.05         1509 3 ENSG00000242485    MRPL20    47074.23          920    46912.53          918 4 ENSG00000160075     SSU72    47815.13          862    47742.10          852 5 ENSG00000078369      GNB1    54464.75          477    54385.81          462 6 ENSG00000187730     GABRD    51521.13          646    51099.35          648        d_diff nSD_dev_subject r_diff nSD_rank_subject 1 0.006628419     -0.04505973      6       0.15937488 2 0.007467317     -0.03697398     11       0.29218728 3 0.003446929     -0.07572463     -2      -0.05312496 4 0.001529688     -0.09420402    -10      -0.26562480 5 0.001451448     -0.09495814    -15      -0.39843720 6 0.008254157     -0.02939000      2       0.05312496"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"visualize-svg-selection-using-svg_nsd-for-batch-effects","dir":"Articles","previous_headings":"Biased Feature Identification","what":"Visualize SVG Selection Using svg_nSD for Batch Effects","title":"Find Batch-biased Features in SVGs","text":"svg_nSD() function generates visualizations assess batch effects spatially variable genes (SVGs). produces bar charts showing distribution SVGs based relative change deviance rank difference, colors representing different nSD intervals. Additionally, scatter plots compare deviance rank values without batch effects. interpreting plots, can determine appropriate nSD thresholds filtering biased features. left panels illustrate distribution SVGs terms deviance rank difference, right panels compare values accounting batch effects. Figure 1. Visualizations nSD_dev nSD_rank threshold selection","code":"plots <- svg_nSD(list_batch_df = list_batch_df,              sd_interval_dev = 3, sd_interval_rank = 3) plots$subject"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"identify-biased-genes-using-biasdetect","dir":"Articles","previous_headings":"Biased Feature Identification","what":"Identify Biased Genes Using biasDetect()","title":"Find Batch-biased Features in SVGs","text":"function biasDetect() designed identify filter biased genes across different batch effects. Using threshold values selected visualization results generated svg_nSD(), function systematically detects outliers exceed specified number standard deviation (nSD) threshold either relative deviance change, rank difference, . function outputs visualizations comparing deviance rank values without batch effects. Genes high deviations, highlighted color, identified potentially biased can excluded based selected nSD thresholds. function offers flexibility customizing plot aesthetics, allowing users adjust data point size (plot_point_size), shape (plot_point_shape), annotated text size (plot_text_size), data point color palette (plot_palette). Default values provided parameters specified. Users refer ggplot2 aesthetic guidelines ensure appropriate values assigned parameter. use nSD_dev = 3 nSD_rank = 3 example. user adjust value based dataset features. Usage Different Threshold Options threshold = \"dev\": Filters biased genes based relative change deviance. Genes deviance changes exceeding specified nSD_dev threshold identified batch-affected can removed. Table 1. Outlier Genes defined nSD_dev can change data point size using plot_point_size. Figure 2. Customize point size  threshold = \"rank\": Identifies biased genes based solely rank difference. Genes rank shifts exceeding nSD_rank considered biased. Table 2. Outlier Genes defined nSD_rank can change data point shape using plot_point_shape. Figure 3. Customize point shape  threshold = \"\": Detects biased genes based deviance change rank difference, providing stringent filtering approach. Table 3. Outlier Genes defined nSD_dev nSD_rank can change data point color using plot_palette. color palette can referenced since function uses RColorBrewer generate colors. Figure 4. Customize palette color  can change text size using plot_text_size. also specify color palettes batch effects time. Figure 5. Customize text size color palette","code":"bias_dev <- biasDetect(list_batch_df = list_batch_df,      threshold = \"dev\", nSD_dev = 3) head(bias_dev$subject$Table)           gene_id gene_name dev_default rank_default dev_subject rank_subject 1 ENSG00000255823  MTRNR2L8    286927.9            5    67738.95           77 2 ENSG00000087250       MT3    115108.2           21    86093.50           31 3 ENSG00000256618  MTRNR2L1    167381.9           14    40299.65         1368 4 ENSG00000198840    MT-ND3    170192.2           12   120647.03           17      d_diff nSD_dev_subject r_diff nSD_rank_subject nSD_bin_dev dev_outlier 1 3.2357886       31.079310     72        1.9124986     [30,33]        TRUE 2 0.3370142        3.139375     10        0.2656248       [3,6)        TRUE 3 3.1534316       30.285509   1354       35.9655982     [30,33]        TRUE 4 0.4106625        3.849237      5        0.1328124       [3,6)        TRUE # size default = 3 bias_dev_size <- biasDetect(list_batch_df = list_batch_df,      threshold = \"dev\", nSD_dev = 3, plot_point_size = 4) plot_grid(bias_dev$subject$Plot, bias_dev_size$subject$Plot) bias_rank <- biasDetect(list_batch_df = list_batch_df,      threshold = \"rank\", nSD_rank = 3) head(bias_rank$subject$Table)           gene_id gene_name dev_default rank_default dev_subject rank_subject 1 ENSG00000184144     CNTN2    44388.43         1101    42016.77         1258 2 ENSG00000136541      ERMN    48106.50          844    44879.30         1036 3 ENSG00000013297    CLDN11    53385.84          539    49776.21          732 4 ENSG00000164124   TMEM144    39407.07         1471    37587.88         1605 5 ENSG00000204655       MOG    37293.40         1648    35613.38         1762 6 ENSG00000091129     NRCAM    51388.42          655    49006.18          776       d_diff nSD_dev_subject r_diff nSD_rank_subject nSD_bin_rank rank_outlier 1 0.05644564       0.4351052    157         4.170309        [3,6)         TRUE 2 0.07190853       0.5841448    192         5.099996        [3,6)         TRUE 3 0.07251725       0.5900120    193         5.126559        [3,6)         TRUE 4 0.04839817       0.3575395    134         3.559372        [3,6)         TRUE 5 0.04717397       0.3457399    114         3.028123        [3,6)         TRUE 6 0.04861096       0.3595904    121         3.214060        [3,6)         TRUE # shape default = 16 bias_rank_shape <- biasDetect(list_batch_df = list_batch_df,      threshold = \"rank\", nSD_rank = 3, plot_point_shape = 2)  plot_grid(bias_rank$subject$Plot, bias_rank_shape$subject$Plot) bias_both <- biasDetect(list_batch_df = list_batch_df, threshold = \"both\",     nSD_dev = 3, nSD_rank = 3) head(bias_both$subject$Table)           gene_id gene_name dev_default rank_default dev_subject rank_subject 1 ENSG00000184144     CNTN2    44388.43         1101    42016.77         1258 2 ENSG00000136541      ERMN    48106.50          844    44879.30         1036 3 ENSG00000013297    CLDN11    53385.84          539    49776.21          732 4 ENSG00000164124   TMEM144    39407.07         1471    37587.88         1605 5 ENSG00000204655       MOG    37293.40         1648    35613.38         1762 6 ENSG00000091129     NRCAM    51388.42          655    49006.18          776       d_diff nSD_dev_subject r_diff nSD_rank_subject nSD_bin_dev dev_outlier 1 0.05644564       0.4351052    157         4.170309       [0,3)       FALSE 2 0.07190853       0.5841448    192         5.099996       [0,3)       FALSE 3 0.07251725       0.5900120    193         5.126559       [0,3)       FALSE 4 0.04839817       0.3575395    134         3.559372       [0,3)       FALSE 5 0.04717397       0.3457399    114         3.028123       [0,3)       FALSE 6 0.04861096       0.3595904    121         3.214060       [0,3)       FALSE   nSD_bin_rank rank_outlier 1        [3,6)         TRUE 2        [3,6)         TRUE 3        [3,6)         TRUE 4        [3,6)         TRUE 5        [3,6)         TRUE 6        [3,6)         TRUE # color default = \"YlOrRd\" bias_both_color <- biasDetect(list_batch_df = list_batch_df,      threshold = \"both\", nSD_dev = 3, nSD_rank = 3, plot_palette = \"Greens\")  plot_grid(bias_both$subject$Plot, bias_both_color$subject$Plot,nrow = 2) # text size default = 3 bias_both_color_text <- biasDetect(list_batch_df = list_batch_df,      threshold = \"both\", nSD_dev = 3, nSD_rank = 3,      plot_palette = c(\"Blues\"), plot_text_size = 4)  plot_grid(bias_both$subject$Plot, bias_both_color_text$subject$Plot,nrow = 2)"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"refine-svgs-by-removing-batch-affected-outliers","dir":"Articles","previous_headings":"Biased Feature Identification","what":"Refine SVGs by Removing Batch-Affected Outliers","title":"Find Batch-biased Features in SVGs","text":"Finally, obtain refined set spatially variable genes (SVGs) removing identified outliers based user-defined thresholds nSD_dev nSD_rank. , use results bias_both, applied threshold = \"\" account deviance rank differences, batch effect set sample ID. obtaining refined set SVGs, genes can analyzed using established spatial transcriptomics clustering algorithms explore tissue layers spatial organization.","code":"bias_both_df <- bias_both$subject$Table svgs_filt <- setdiff(libd_nnsvgs$gene_id, bias_both_df$gene_id) svgs_filt_spe <- libd_nnsvgs[libd_nnsvgs$gene_id %in% svgs_filt, ] nrow(svgs_filt_spe) [1] 1951"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"r-session-information","dir":"Articles","previous_headings":"","what":"R session information","title":"Find Batch-biased Features in SVGs","text":"","code":"## Session info sessionInfo() #> R version 4.4.3 (2025-02-28) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.2 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] cowplot_1.1.3               spatialLIBD_1.18.0          #>  [3] SpatialExperiment_1.16.0    SingleCellExperiment_1.28.1 #>  [5] SummarizedExperiment_1.36.0 Biobase_2.66.0              #>  [7] GenomicRanges_1.58.0        GenomeInfoDb_1.42.3         #>  [9] IRanges_2.40.1              S4Vectors_0.44.0            #> [11] BiocGenerics_0.52.0         MatrixGenerics_1.18.1       #> [13] matrixStats_1.5.0           BatchSVG_0.99.8             #> [15] BiocStyle_2.34.0            #>  #> loaded via a namespace (and not attached): #>   [1] RColorBrewer_1.1-3       jsonlite_2.0.0           magrittr_2.0.3           #>   [4] ggbeeswarm_0.7.2         magick_2.8.6             farver_2.1.2             #>   [7] rmarkdown_2.29           BiocIO_1.16.0            fs_1.6.5                 #>  [10] fields_16.3.1            zlibbioc_1.52.0          ragg_1.3.3               #>  [13] vctrs_0.6.5              Rsamtools_2.22.0         config_0.3.2             #>  [16] memoise_2.0.1            RCurl_1.98-1.17          paletteer_1.6.0          #>  [19] benchmarkme_1.0.8        htmltools_0.5.8.1        S4Arrays_1.6.0           #>  [22] AnnotationHub_3.14.0     curl_6.2.2               BiocNeighbors_2.0.1      #>  [25] SparseArray_1.6.2        sass_0.4.9               bslib_0.9.0              #>  [28] htmlwidgets_1.6.4        desc_1.4.3               plotly_4.10.4            #>  [31] cachem_1.1.0             GenomicAlignments_1.42.0 mime_0.13                #>  [34] lifecycle_1.0.4          iterators_1.0.14         pkgconfig_2.0.3          #>  [37] rsvd_1.0.5               Matrix_1.7-2             R6_2.6.1                 #>  [40] fastmap_1.2.0            GenomeInfoDbData_1.2.13  shiny_1.10.0             #>  [43] digest_0.6.37            colorspace_2.1-1         rematch2_2.1.2           #>  [46] AnnotationDbi_1.68.0     scater_1.34.1            irlba_2.3.5.1            #>  [49] ExperimentHub_2.14.0     textshaping_1.0.0        RSQLite_2.3.9            #>  [52] beachmat_2.22.0          labeling_0.4.3           filelock_1.0.3           #>  [55] httr_1.4.7               abind_1.4-8              compiler_4.4.3           #>  [58] withr_3.0.2              attempt_0.3.1            bit64_4.6.0-1            #>  [61] doParallel_1.0.17        BiocParallel_1.40.0      viridis_0.6.5            #>  [64] DBI_1.2.3                maps_3.4.2.1             sessioninfo_1.2.3        #>  [67] rappdirs_0.3.3           DelayedArray_0.32.0      rjson_0.2.23             #>  [70] tools_4.4.3              vipor_0.4.7              beeswarm_0.4.0           #>  [73] httpuv_1.6.15            glue_1.8.0               restfulr_0.0.15          #>  [76] promises_1.3.2           grid_4.4.3               generics_0.1.3           #>  [79] gtable_0.3.6             tidyr_1.3.1              data.table_1.17.0        #>  [82] BiocSingular_1.22.0      ScaledMatrix_1.14.0      XVector_0.46.0           #>  [85] stringr_1.5.1            ggrepel_0.9.6            BiocVersion_3.20.0       #>  [88] foreach_1.5.2            pillar_1.10.1            spam_2.11-1              #>  [91] limma_3.62.2             later_1.4.1              benchmarkmeData_1.0.4    #>  [94] dplyr_1.1.4              BiocFileCache_2.14.0     lattice_0.22-6           #>  [97] rtracklayer_1.66.0       bit_4.6.0                tidyselect_1.2.1         #> [100] locfit_1.5-9.12          scuttle_1.16.0           Biostrings_2.74.1        #> [103] knitr_1.50               gridExtra_2.3            bookdown_0.42            #> [106] edgeR_4.4.2              xfun_0.51                statmod_1.5.0            #> [109] DT_0.33                  stringi_1.8.7            UCSC.utils_1.2.0         #> [112] lazyeval_0.2.2           yaml_2.3.10              shinyWidgets_0.9.0       #> [115] evaluate_1.0.3           codetools_0.2-20         tibble_3.2.1             #> [118] BiocManager_1.30.25      cli_3.6.4                xtable_1.8-4             #> [121] systemfonts_1.2.1        munsell_0.5.1            jquerylib_0.1.4          #> [124] golem_0.5.1              Rcpp_1.0.14              dbplyr_2.5.0             #> [127] scry_1.18.0              png_0.1-8                XML_3.99-0.18            #> [130] parallel_4.4.3           pkgdown_2.1.1            ggplot2_3.5.1            #> [133] blob_1.2.4               dotCall64_1.2            bitops_1.0-9             #> [136] viridisLite_0.4.2        scales_1.3.0             purrr_1.0.4              #> [139] crayon_1.5.3             rlang_1.1.5              KEGGREST_1.46.0"},{"path":"https://christinehou11.github.io/BatchSVG/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Christine Hou. Author, maintainer. Jacqui Thompson. Author. Stephanie C. Hicks. Author, funder.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hou C, Thompson J, Hicks S (2025). BatchSVG: Identify Batch-Biased Features Spatially Variable Genes. R package version 0.99.8, https://christinehou11.github.io/BatchSVG, https://github.com/christinehou11/BatchSVG.","code":"@Manual{,   title = {BatchSVG: Identify Batch-Biased Features in Spatially Variable Genes},   author = {Christine Hou and Jacqui Thompson and Stephanie C. Hicks},   year = {2025},   note = {R package version 0.99.8,     https://christinehou11.github.io/BatchSVG},   url = {https://github.com/christinehou11/BatchSVG}, }"},{"path":"https://christinehou11.github.io/BatchSVG/index.html","id":"batchsvg","dir":"","previous_headings":"","what":"BatchSVG","title":"Identify Batch-Biased Features in Spatially Variable Genes","text":"BatchSVG feature-based Quality Control (QC) identify SVGs spatial transcriptomics data specific types batch effect. Regarding spatial transcriptomics data experients, batch can defined “sample”, “sex”, etc.BatchSVG method based binomial deviance model (Townes et al, 2019)) applies cutoffs based number standard deviation (nSD) relative change deviance rank difference data-driven thresholding approach detect batch-biased outliers.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/index.html","id":"installation","dir":"","previous_headings":"BatchSVG","what":"Installation","title":"Identify Batch-Biased Features in Spatially Variable Genes","text":"BatchSVG R package available Bioconductor version 3.19 later. can install BatchSVG using following commands R session Bioconductor. development version can obtained ","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {     install.packages(\"BiocManager\") }  BiocManager::install(\"BatchSVG\")  ## Check that you have a valid Bioconductor installation BiocManager::valid() BiocManager::install(\"christinehou11/BatchSVG\")"},{"path":"https://christinehou11.github.io/BatchSVG/index.html","id":"code-of-conduct","dir":"","previous_headings":"BatchSVG","what":"Code of Conduct","title":"Identify Batch-Biased Features in Spatially Variable Genes","text":"Please note BatchSVG project released Contributor Code Conduct. contributing project, agree abide terms.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/biasDetect.html","id":null,"dir":"Reference","previous_headings":"","what":"Biased Genes Identification — biasDetect","title":"Biased Genes Identification — biasDetect","text":"Function identify bias genes based user-selected threshold number standard deviation relative change deviance rank difference.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/biasDetect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Biased Genes Identification — biasDetect","text":"","code":"biasDetect(   list_batch_df,   threshold = \"both\",   nSD_dev = NULL,   nSD_rank = NULL,   plot_point_size = 3,   plot_point_shape = 16,   plot_text_size = 3,   plot_palette = \"YlOrRd\" )"},{"path":"https://christinehou11.github.io/BatchSVG/reference/biasDetect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Biased Genes Identification — biasDetect","text":"list_batch_df list : list data frame(s) generated featureSelection() function. length data frame list least one. threshold character string specifying filtering criterion. Must one : \"dev\": Filters genes based deviance threshold . \"rank\": Filters genes based rank threshold . \"\": Filters genes based either deviance rank threshold. Default \"\". nSD_dev integer: numeric vector specifying number standard deviation (nSD) batch analyzing relative change deviance. order values must correspond order batches list_batch_df. Required threshold \"dev\" \"\". single value provided, applied batches; otherwise, must length list_batch_df. nSD_rank vector: numeric vector specifying number standard deviation (nSD) batch analyzing rank differences. order values must correspond order batches list_batch_df. Required threshold \"rank\" \"\". single value provided, applied batches; otherwise, must length list_batch_df. plot_point_size vector: numeric vector specifying point sizes plots. asingle value provided, applied batches. plot_point_shape vector: numeric vector specifying point shapes plots. single value provided, applied batches. plot_text_size vector: numeric vector specifying text label size plots. Default 3. plot_palette vector: character string vector specifying color palette plots. Default \"YlOrRd\".","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/biasDetect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Biased Genes Identification — biasDetect","text":"named list element corresponds batch contains: \"Plot\": diagnostic plot (either deviance, rank, ). \"Table\": filtered data frame containing outlier genes based specified threshold.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/biasDetect.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Biased Genes Identification — biasDetect","text":"","code":"# use the result generated from featureSelect() load(system.file(\"extdata\",\"list_batch_df.rda\", package = \"BatchSVG\")) biaGenes <- biasDetect(list_batch_df = list_batch_df, threshold = \"both\",     nSD_dev = 3, nSD_rank = 3)"},{"path":"https://christinehou11.github.io/BatchSVG/reference/featureSelect.html","id":null,"dir":"Reference","previous_headings":"","what":"Feature selection — featureSelect","title":"Feature selection — featureSelect","text":"function computes batch-adjusted deviance values, ranks genes accordingly, quantifies batch effects terms standard deviations mean difference. list follows order batch effects provided batch_effects.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/featureSelect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Feature selection — featureSelect","text":"","code":"featureSelect(input, batch_effects = NULL, VGs = NULL)"},{"path":"https://christinehou11.github.io/BatchSVG/reference/featureSelect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Feature selection — featureSelect","text":"input SpatialExperiment object containing spatial transcriptomics data.. batch_effects character vector specifying column names colData(input) indicate batch effects. Must match existing column names. VGs character vector specifying variable genes (VGs) analyzed. genes present vector retained feature selection.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/featureSelect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Feature selection — featureSelect","text":"named list element corresponds batch effect. batch contains data frame following columns: \"gene_id\": Gene identifier. \"gene_name\": Gene name. \"dev_default\": Deviance score without batch correction. \"dev_\": Deviance score batch correction. \"rank_default\": Rank gene based deviance without batch correction. \"rank_\": Rank gene based deviance batch correction. \"d_diff\": Relative change deviance default batch-corrected models. \"nSD_dev_\": number standard deviation relative change deviance batch. \"r_diff\": Rank difference default batch-corrected models. \"nSD_rank_\": number standard deviation rank difference batch.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/featureSelect.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Feature selection — featureSelect","text":"","code":"library(spatialLIBD) #> Loading required package: SpatialExperiment #> Loading required package: SingleCellExperiment #> Loading required package: SummarizedExperiment #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: ‘MatrixGenerics’ #> The following objects are masked from ‘package:matrixStats’: #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats, #>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds, #>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads, #>     colWeightedMeans, colWeightedMedians, colWeightedSds, #>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet, #>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods, #>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps, #>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins, #>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks, #>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #>  #> Attaching package: ‘BiocGenerics’ #> The following objects are masked from ‘package:stats’: #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from ‘package:base’: #>  #>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append, #>     as.data.frame, basename, cbind, colnames, dirname, do.call, #>     duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted, #>     lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin, #>     pmin.int, rank, rbind, rownames, sapply, saveRDS, setdiff, table, #>     tapply, union, unique, unsplit, which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: ‘S4Vectors’ #> The following object is masked from ‘package:utils’: #>  #>     findMatches #> The following objects are masked from ‘package:base’: #>  #>     I, expand.grid, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'. #>  #> Attaching package: ‘Biobase’ #> The following object is masked from ‘package:MatrixGenerics’: #>  #>     rowMedians #> The following objects are masked from ‘package:matrixStats’: #>  #>     anyMissing, rowMedians spatialLIBD_spe <- fetch_data(type = \"spe\") #> adding rname 'https://www.dropbox.com/s/f4wcvtdq428y73p/Human_DLPFC_Visium_processedData_sce_scran_spatialLIBD.Rdata?dl=1' #> 2025-03-31 00:32:35.29746 loading file /home/runner/.cache/R/BiocFileCache/38245eec57cd_Human_DLPFC_Visium_processedData_sce_scran_spatialLIBD.Rdata%3Fdl%3D1 libd_svg <- read.csv(     system.file(\"extdata\",\"libd-all_nnSVG_p-05-features-df.csv\",               package = \"BatchSVG\"),     row.names = 1, check.names = FALSE)     list_batch_df <- featureSelect(input = spatialLIBD_spe,     batch_effects = \"subject\", VGs = libd_svg$gene_id) #> Running feature selection without batch... #> Batch Effect: subject #> Running feature selection without batch... #> Calculating deviance and rank difference..."},{"path":"https://christinehou11.github.io/BatchSVG/reference/svg_nSD.html","id":null,"dir":"Reference","previous_headings":"","what":"SVGs Plots — svg_nSD","title":"SVGs Plots — svg_nSD","text":"function generates visualizations assess impact batch effects spatially variable genes (SVGs) analyzing changes deviance rank. function bins deviations normalized standard deviation (nSD) intervals creates histograms scatter plots illustrate distribution batch effects.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/svg_nSD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SVGs Plots — svg_nSD","text":"","code":"svg_nSD(list_batch_df, sd_interval_dev, sd_interval_rank)"},{"path":"https://christinehou11.github.io/BatchSVG/reference/svg_nSD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SVGs Plots — svg_nSD","text":"list_batch_df named list data frames, data frame corresponds batch effect contains columns deviance rank differences. sd_interval_dev numeric vector specifying interval widths standard deviation bins batch analyzing relative change deviance. order values must correspond order batches list_batch_df . single value provided, applied batches; otherwise, must length list_batch_df. sd_interval_rank vector: numeric vector specifying interval widths standard deviation bins analyzing rank differences. order values must correspond order batches list_batch_df. single value provided, applied batches; otherwise, must length list_batch_df.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/svg_nSD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SVGs Plots — svg_nSD","text":"combined ggplot object containing: Deviance Plots: Histogram deviance differences across SVGs, colored nSD intervals. Scatter plot comparing deviance values batch correction. Rank Plots: Histogram rank differences across SVGs, colored nSD intervals. Scatter plot comparing ranks batch correction. function arranges plots batch grid format easy comparison.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/svg_nSD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SVGs Plots — svg_nSD","text":"","code":"# use the result generated from featureSelect() load(system.file(\"extdata\",\"list_batch_df.rda\", package = \"BatchSVG\")) plots <- svg_nSD(list_batch_df = list_batch_df,     sd_interval_dev = 3, sd_interval_rank = 3)"},{"path":"https://christinehou11.github.io/BatchSVG/news/index.html","id":"batchsvg-0998","dir":"Changelog","previous_headings":"","what":"BatchSVG 0.99.8","title":"BatchSVG 0.99.8","text":"Fixes rank plot x/y labels","code":""},{"path":"https://christinehou11.github.io/BatchSVG/news/index.html","id":"batchsvg-0997","dir":"Changelog","previous_headings":"","what":"BatchSVG 0.99.7","title":"BatchSVG 0.99.7","text":"Bug fixs","code":""},{"path":"https://christinehou11.github.io/BatchSVG/news/index.html","id":"batchsvg-0996","dir":"Changelog","previous_headings":"","what":"BatchSVG 0.99.6","title":"BatchSVG 0.99.6","text":"Updated vignette using spatialLIBD spe dataset","code":""},{"path":"https://christinehou11.github.io/BatchSVG/news/index.html","id":"batchsvg-0995","dir":"Changelog","previous_headings":"","what":"BatchSVG 0.99.5","title":"BatchSVG 0.99.5","text":"Bug fix example dataset","code":""},{"path":"https://christinehou11.github.io/BatchSVG/news/index.html","id":"batchsvg-0994","dir":"Changelog","previous_headings":"","what":"BatchSVG 0.99.4","title":"BatchSVG 0.99.4","text":"Updated test example datasets (spatialLIBD spe dataset)","code":""},{"path":"https://christinehou11.github.io/BatchSVG/news/index.html","id":"batchsvg-0993","dir":"Changelog","previous_headings":"","what":"BatchSVG 0.99.3","title":"BatchSVG 0.99.3","text":"Deleted CITATION (preprint now)","code":""},{"path":"https://christinehou11.github.io/BatchSVG/news/index.html","id":"batchsvg-0992","dir":"Changelog","previous_headings":"","what":"BatchSVG 0.99.2","title":"BatchSVG 0.99.2","text":"Added inst/scripts describe external data source svgs_sub4.csv","code":""},{"path":"https://christinehou11.github.io/BatchSVG/news/index.html","id":"batchsvg-0991","dir":"Changelog","previous_headings":"","what":"BatchSVG 0.99.1","title":"BatchSVG 0.99.1","text":"Added NEWS.md file track changes package.","code":""}]
