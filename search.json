[{"path":[]},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported community leaders responsible enforcement chris2018hou@gmail.com. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.1, available https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Community Impact Guidelines inspired [Mozilla’s code conduct enforcement ladder][https://github.com/mozilla/inclusion]. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to BatchSVG","title":"Contributing to BatchSVG","text":"outlines propose change BatchSVG. detailed discussion contributing tidyverse packages, please see development contributing guide code review principles.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to BatchSVG","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ’ll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":"bigger-changes","dir":"","previous_headings":"","what":"Bigger changes","title":"Contributing to BatchSVG","text":"want make bigger change, ’s good idea first file issue make sure someone team agrees ’s needed. ’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed). See guide create great issue advice.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Bigger changes","what":"Pull request process","title":"Contributing to BatchSVG","text":"Fork package clone onto computer. haven’t done , recommend using usethis::create_from_github(\"christinehou11/BatchSVG\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn’t pass cleanly, ’s good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e. just first header). Follow style described https://style.tidyverse.org/news.html.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Bigger changes","what":"Code style","title":"Contributing to BatchSVG","text":"New code follow tidyverse style guide. can use styler package apply styles, please don’t restyle code nothing PR. use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to BatchSVG","text":"Please note BatchSVG project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/SUPPORT.html","id":null,"dir":"","previous_headings":"","what":"Getting help with BatchSVG","title":"Getting help with BatchSVG","text":"Thank using BatchSVG! filing issue, things know make process smooth possible parties.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/SUPPORT.html","id":"make-a-reprex","dir":"","previous_headings":"","what":"Make a reprex","title":"Getting help with BatchSVG","text":"Start making minimally reproducible example, also known ‘reprex’. may use reprex R package create one, though necessary help. make R-question-asking endeavors easier. Learning use takes 5 10 minutes. tips make minimally reproducible example, see StackOverflow link.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/SUPPORT.html","id":"where-to-post-it","dir":"","previous_headings":"","what":"Where to post it?","title":"Getting help with BatchSVG","text":"Bioconductor help web page gives overview places may help answer question. Bioconductor software related questions, bug reports feature requests, addressed appropriate Bioconductor/BatchSVG GitHub repository. Follow bug report feature request templates GitHub. package GitHub repository, see next bullet point. Bioconductor software usage questions addressed Bioconductor Support Website. Make sure use appropriate package tag, otherwise package authors get notification. General R questions can posed StackOverflow RStudio Community website especially pertain tidyverse RStudio GUI related products.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/SUPPORT.html","id":"issues-or-feature-requests","dir":"","previous_headings":"","what":"Issues or Feature Requests","title":"Getting help with BatchSVG","text":"opening new issue feature request, sure search issues pull requests ensure one already exist implemented development version. Note. can remove :open search term issues page search open closed issues. See link learn modifying search.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/SUPPORT.html","id":"what-happens-next","dir":"","previous_headings":"","what":"What happens next?","title":"Getting help with BatchSVG","text":"Bioconductor maintainers limited resources strive responsive possible. Please forget tag appropriate maintainer issue GitHub username (e.g., @username). order make easy possible Bioconductor core developers remediate issue. Provide accurate, brief, reproducible report outlined issue templates. Thank trusting Bioconductor.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Find Bias Features - Spatial Transcriptomics Data","text":"BatchSVG R/Bioconductor package spatial transcriptomics data quality control (QC). feature-based QC method, package provides functions identify biased features associated batch effect(s) (e.g. sample, slide, sex) spatially variable genes (SVGs) using binomial deviance model, aiming develop downstream clustering performances remove technical noises caused batch effects. package works SpatialExperiment objects.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Find Bias Features - Spatial Transcriptomics Data","text":"(accepted Bioconductor). Install development version GitHub.","code":"if (!requireNamespace(\"BiocManager\")) {     install.packages(\"BiocManager\") } BiocManager::install(\"HuBMAPR\") remotes::install(\"christinehou11/BatchSVG\")"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"biased-feature-identification","dir":"Articles","previous_headings":"","what":"Biased Feature Identification","title":"Find Bias Features - Spatial Transcriptomics Data","text":"section, include standard workflow using BatchSVG show method help detect visualize biased features SVGs.","code":"library(BatchSVG) # library(humanHippocampus2024) library(ExperimentHub) library(SpatialExperiment) library(SummarizedExperiment) library(tidyr) library(dplyr) library(tibble)"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"data","dir":"Articles","previous_headings":"Biased Feature Identification","what":"Data","title":"Find Bias Features - Spatial Transcriptomics Data","text":"use spatially-resolved transcriptomics (SRT) dataset adjacent tissue sections anterior human hippocampus across ten adult neurotypical donors. dataset obtained humanHippocampus2024 package currently development version Bioconductor 3.21, spatialExperiment object generated processed spatial_HPC project. use spatially variable genes set generated spatial_HPC project. result generated nnSVG package. select four samples raw data example: V11L05-333_B1 V11L05-333_D1 V11L05-335_D1 V11L05-336_A1. refine selection include top 2,000 ranked features (rank≤\\leq 2000) genes appear one sample (n > 1). applying criteria, obtain 2,082 spatially variable genes across four samples.","code":"ehub <- ExperimentHub() spe <- ehub[[\"EH9605\"]] spe class: SpatialExperiment  dim: 31483 150917  metadata(1): Obtained_from assays(2): counts logcounts rownames(31483): MIR1302-2HG AL627309.1 ... AC007325.4 AC007325.2 rowData names(7): source type ... gene_type gene_search colnames(150917): AAACAACGAATAGTTC-1_V10B01-086_D1   AAACAAGTATCTCCCA-1_V10B01-086_D1 ... TTGTTTCCATACAACT-1_Br2720_B1   TTGTTTGTATTACACG-1_Br2720_B1 colData names(150): sample_id in_tissue ... nmf99 nmf100 reducedDimNames(3): 10x_pca 10x_tsne 10x_umap mainExpName: NULL altExpNames(0): spatialCoords names(2) : pxl_col_in_fullres pxl_row_in_fullres imgData names(4): sample_id image_id data scaleFactor fix_order <- distinct(     as.data.frame(colData(spe)), slide, array, brnum, sample_id,      position, sex) %>%      arrange(slide, array) sub4 <- fix_order$sample_id[c(14,16, 20,21)]  spe_sub4 <- spe[,spe$sample_id %in% sub4] spe_sub4 # 31483, 18945 class: SpatialExperiment  dim: 31483 18945  metadata(1): Obtained_from assays(2): counts logcounts rownames(31483): MIR1302-2HG AL627309.1 ... AC007325.4 AC007325.2 rowData names(7): source type ... gene_type gene_search colnames(18945): AAACAACGAATAGTTC-1_V11L05-333_B1   AAACAAGTATCTCCCA-1_V11L05-333_B1 ... TTGTTTGTATTACACG-1_V11L05-336_A1   TTGTTTGTGTAAATTC-1_V11L05-336_A1 colData names(150): sample_id in_tissue ... nmf99 nmf100 reducedDimNames(3): 10x_pca 10x_tsne 10x_umap mainExpName: NULL altExpNames(0): spatialCoords names(2) : pxl_col_in_fullres pxl_row_in_fullres imgData names(4): sample_id image_id data scaleFactor # res_ranks: SVGs results with rank values res_df_sub <- pivot_longer(     rownames_to_column(as.data.frame(res_ranks), var<-\"gene_id\"),          colnames(res_ranks),      names_to=\"sample_id\",      values_to=\"rank\",      values_drop_na=TRUE)      res_df_sub <- filter(res_df_sub,     sample_id %in%          c(\"V11L05-333_B1\", \"V11L05-333_D1\", \"V11L05-335_D1\", \"V11L05-336_A1\"),      rank <= 2000) # top 2k sig features      svgs_sub4 <- group_by(res_df_sub, gene_id) |>     tally() |>      filter(n>1) [1] 2082 nrow(svgs_sub4)"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"perform-feature-selection-using-featureselect","dir":"Articles","previous_headings":"Biased Feature Identification","what":"Perform Feature Selection using featureSelect()","title":"Find Bias Features - Spatial Transcriptomics Data","text":"perform feature selection subset spatial transcriptomics data (input) using predefined set spatially variable genes (VGs). Specifically, compute number standard deviations relative change deviance (nSD_dev_{batch effect}) rank difference (nSD_rank_{batch effect}) adjusting batch effects. featureSelect() function enables feature selection accounting multiple batch effects. returns list data frames, batch effect associated corresponding data frame containing key results, including: Relative change deviance batch effect adjustment Rank differences batch-corrected uncorrected results Number standard deviations (nSD) relative change deviance rank difference use example applying featureSelect() four sample dataset adjusting batch effect sample_id sex.","code":"SVGs <- svgs_sub4$gene_id list_batch_df <- featureSelect(input = spe_sub4,      batch_effect = c(\"sample_id\", \"sex\"), VGs = SVGs) Running feature selection without batch... Batch Effect: sample_id Running feature selection without batch... Calculating deviance and rank difference... Batch Effect: sex Running feature selection without batch... Calculating deviance and rank difference... class(list_batch_df) [1] \"list\" head(list_batch_df$sample_id)           gene_id gene_name dev_default rank_default dev_sample_id 1 ENSG00000131584     ACAP3    16125.31         1262      15900.14 2 ENSG00000175756  AURKAIP1    17344.09         1060      17167.86 3 ENSG00000242485    MRPL20    17629.33         1023      17517.05 4 ENSG00000179403      VWA1    12860.93         1726      12825.66 5 ENSG00000160075     SSU72    16145.20         1255      16136.31 6 ENSG00000078369      GNB1    22402.83          516      22271.32   rank_sample_id       d_diff nSD_dev_sample_id r_diff nSD_rank_sample_id 1           1269 0.0141612453       -0.09513109      7         0.16380252 2           1058 0.0102651525       -0.16945410     -2        -0.04680072 3           1004 0.0064098269       -0.24299943    -19        -0.44460683 4           1702 0.0027493688       -0.31282741    -24        -0.56160863 5           1220 0.0005506572       -0.35477067    -35        -0.81901258 6            497 0.0059049925       -0.25262980    -19        -0.44460683 head(list_batch_df$sex)           gene_id gene_name dev_default rank_default  dev_sex rank_sex 1 ENSG00000131584     ACAP3    16125.31         1262 16118.48     1250 2 ENSG00000175756  AURKAIP1    17344.09         1060 17247.44     1064 3 ENSG00000242485    MRPL20    17629.33         1023 17585.70     1013 4 ENSG00000179403      VWA1    12860.93         1726 12860.90     1709 5 ENSG00000160075     SSU72    16145.20         1255 16141.12     1243 6 ENSG00000078369      GNB1    22402.83          516 22314.17      509         d_diff nSD_dev_sex r_diff nSD_rank_sex 1 4.234208e-04  -0.2615600    -12   -0.3080188 2 5.603690e-03  -0.1013769      4    0.1026729 3 2.480783e-03  -0.1979427    -10   -0.2566824 4 1.811106e-06  -0.2745969    -17   -0.4363600 5 2.527558e-04  -0.2668373    -12   -0.3080188 6 3.973515e-03  -0.1517848     -7   -0.1796776"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"visualize-svg-selection-using-svg_nsd-for-batch-effects","dir":"Articles","previous_headings":"Biased Feature Identification","what":"Visualize SVG Selection Using svg_nSD for Batch Effects","title":"Find Bias Features - Spatial Transcriptomics Data","text":"svg_nSD() function generates visualizations assess batch effects spatially variable genes (SVGs). produces bar charts showing distribution SVGs based relative change deviance rank difference, colors representing different nSD intervals. Additionally, scatter plots compare deviance rank values without batch effects. interpreting plots, can determine appropriate nSD thresholds filtering biased features. left panels illustrate distribution SVGs terms deviance rank difference, right panels compare values accounting batch effects.   can also apply svg_nSD() single batch effect. Note function requires input list data frames, even analyzing one batch.","code":"plots <- svg_nSD(list_batch_df = list_batch_df,                  sd_interval_dev = c(5,4), sd_interval_rank = c(4,6)) plots$sample_id plots$sex plots <- svg_nSD(list_batch_df = list_batch_df[1],                  sd_interval_dev = 5, sd_interval_rank = 7) plots$sample_id"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"identify-biased-genes-using-biasdetect","dir":"Articles","previous_headings":"Biased Feature Identification","what":"Identify Biased Genes Using biasDetect()","title":"Find Bias Features - Spatial Transcriptomics Data","text":"function biasDetect() designed identify filter biased genes across different batch effects. Using threshold values selected visualization results generated svg_nSD(), function systematically detects outliers exceed specified normalized standard deviation (nSD) threshold either relative deviance change, rank difference, . function outputs visualizations comparing deviance rank values without batch effects. Genes high deviations, highlighted color, identified potentially biased can excluded based selected nSD thresholds. use nSD_dev = 7 nSD_rank = 6 example. user adjust value based dataset features. Usage Different Threshold Options threshold = \"dev\": Filters biased genes based relative change deviance. Genes deviance changes exceeding specified nSD_dev threshold identified batch-affected can removed.  threshold = \"rank\": Identifies biased genes based solely rank difference. Genes rank shifts exceeding nSD_rank considered biased.  threshold = \"\": Detects biased genes based deviance change rank difference, providing stringent filtering approach.","code":"bias_dev <- biasDetect(list_batch_df = list_batch_df,                          threshold = \"dev\", nSD_dev = 7) head(bias_dev$sample_id$Table)           gene_id gene_name dev_default rank_default dev_sample_id 1 ENSG00000174576     NPAS4    35003.31          125     24629.414 2 ENSG00000123358     NR4A1    23299.81          457     16115.928 3 ENSG00000170345       FOS    42305.65           73     27146.089 4 ENSG00000256618  MTRNR2L1    69206.34           28     24876.086 5 ENSG00000118271       TTR  4719046.58            1   3292127.945 6 ENSG00000229807      XIST    15223.50         1408      8819.689   rank_sample_id    d_diff nSD_dev_sample_id r_diff nSD_rank_sample_id 1            363 0.4211996          7.669653    238           5.569286 2           1226 0.4457631          8.138234    769          17.994876 3            263 0.5584435         10.287758    190           4.446068 4            351 1.7820430         33.629502    323           7.558316 5              1 0.4334335          7.903030      0           0.000000 6           2050 0.7260812         13.485664    642          15.023031   nSD_bin_dev dev_outlier 1      [7,14)        TRUE 2      [7,14)        TRUE 3      [7,14)        TRUE 4     [28,35]        TRUE 5      [7,14)        TRUE 6      [7,14)        TRUE bias_dev$sample_id$Plot bias_rank <- biasDetect(list_batch_df = list_batch_df, threshold = \"rank\",                          nSD_rank = 6) head(bias_rank$sex$Table)           gene_id gene_name dev_default rank_default  dev_sex rank_sex 1 ENSG00000159388      BTG2    18311.28          926 14257.70     1543 2 ENSG00000135625      EGR4    20336.84          705 17851.54      972 3 ENSG00000120738      EGR1    19882.54          752 17444.96     1037 4 ENSG00000120129     DUSP1    25054.85          365 19007.41      834 5 ENSG00000204388    HSPA1B    19085.73          841 16440.69     1197 6 ENSG00000130222   GADD45G    16565.74         1191 13815.91     1592      d_diff nSD_dev_sex r_diff nSD_rank_sex nSD_bin_rank rank_outlier 1 0.2843081    8.516661    617    15.837301      [12,18)         TRUE 2 0.1392207    4.030301    267     6.853419       [6,12)         TRUE 3 0.1397297    4.046039    285     7.315447       [6,12)         TRUE 4 0.3181621    9.563487    469    12.038402      [12,18)         TRUE 5 0.1608836    4.700155    356     9.137892       [6,12)         TRUE 6 0.1990332    5.879808    401    10.292962       [6,12)         TRUE bias_rank$sex$Plot bias_both <- biasDetect(list_batch_df = list_batch_df, threshold = \"both\",                     nSD_dev = 7, nSD_rank = 6) head(bias_both$sample_id$Table)           gene_id gene_name dev_default rank_default dev_sample_id 1 ENSG00000159388      BTG2    18311.28          926      14050.66 2 ENSG00000135625      EGR4    20336.84          705      17649.52 3 ENSG00000120738      EGR1    19882.54          752      17278.88 4 ENSG00000120129     DUSP1    25054.85          365      18986.24 5 ENSG00000204388    HSPA1B    19085.73          841      15888.15 6 ENSG00000130222   GADD45G    16565.74         1191      13785.05   rank_sample_id    d_diff nSD_dev_sample_id r_diff nSD_rank_sample_id 1           1558 0.3032334          5.419294    632          14.789027 2            984 0.1522604          2.539289    279           6.528700 3           1039 0.1506844          2.509224    287           6.715903 4            815 0.3196316          5.732111    450          10.530162 5           1271 0.2012558          3.473940    430          10.062155 6           1582 0.2017179          3.482754    391           9.149541   nSD_bin_dev dev_outlier nSD_bin_rank rank_outlier 1       [0,7)       FALSE      [12,18]         TRUE 2       [0,7)       FALSE       [6,12)         TRUE 3       [0,7)       FALSE       [6,12)         TRUE 4       [0,7)       FALSE       [6,12)         TRUE 5       [0,7)       FALSE       [6,12)         TRUE 6       [0,7)       FALSE       [6,12)         TRUE bias_both$sample_id$Plot head(bias_both$sex$Table)           gene_id gene_name dev_default rank_default   dev_sex rank_sex 1 ENSG00000173110     HSPA6    9887.942         2011  7867.831     2074 2 ENSG00000159388      BTG2   18311.285          926 14257.704     1543 3 ENSG00000135625      EGR4   20336.842          705 17851.538      972 4 ENSG00000120738      EGR1   19882.541          752 17444.962     1037 5 ENSG00000120129     DUSP1   25054.848          365 19007.410      834 6 ENSG00000204389    HSPA1A   52523.899           47 41069.968       75      d_diff nSD_dev_sex r_diff nSD_rank_sex nSD_bin_dev dev_outlier 1 0.2567557    7.664691     63    1.6170988      [7,14)        TRUE 2 0.2843081    8.516661    617   15.8373012      [7,14)        TRUE 3 0.1392207    4.030301    267    6.8534188       [0,7)       FALSE 4 0.1397297    4.046039    285    7.3154471       [0,7)       FALSE 5 0.3181621    9.563487    469   12.0384024      [7,14)        TRUE 6 0.2788882    8.349068     28    0.7187106      [7,14)        TRUE   nSD_bin_rank rank_outlier 1        [0,6)        FALSE 2      [12,18)         TRUE 3       [6,12)         TRUE 4       [6,12)         TRUE 5      [12,18)         TRUE 6        [0,6)        FALSE bias_both$sex$Plot"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"refine-svgs-by-removing-batch-affected-outliers","dir":"Articles","previous_headings":"Biased Feature Identification","what":"Refine SVGs by Removing Batch-Affected Outliers","title":"Find Bias Features - Spatial Transcriptomics Data","text":"Finally, obtain refined set spatially variable genes (SVGs) removing identified outliers based user-defined thresholds nSD_dev nSD_rank. , use results bias_both, applied threshold = \"\" account deviance rank differences, batch effect set sample ID. obtaining refined set SVGs, genes can analyzed using established spatial transcriptomics clustering algorithms explore tissue layers spatial organization.","code":"bias_both_df <- bias_both$sample_id$Table svgs_filt <- setdiff(svgs_sub4$gene_id, bias_both_df$gene_id) svgs_sub4_filt <- svgs_sub4[svgs_sub4$gene_id %in% svgs_filt, ] nrow(svgs_sub4_filt) [1] 2067"},{"path":"https://christinehou11.github.io/BatchSVG/articles/spe.html","id":"r-session-information","dir":"Articles","previous_headings":"","what":"R session information","title":"Find Bias Features - Spatial Transcriptomics Data","text":"","code":"## Session info sessionInfo() #> R version 4.4.2 (2024-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.2 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] tibble_3.2.1                dplyr_1.1.4                 #>  [3] tidyr_1.3.1                 SpatialExperiment_1.16.0    #>  [5] SingleCellExperiment_1.28.1 SummarizedExperiment_1.36.0 #>  [7] Biobase_2.66.0              GenomicRanges_1.58.0        #>  [9] GenomeInfoDb_1.42.3         IRanges_2.40.1              #> [11] S4Vectors_0.44.0            MatrixGenerics_1.18.1       #> [13] matrixStats_1.5.0           ExperimentHub_2.14.0        #> [15] AnnotationHub_3.14.0        BiocFileCache_2.14.0        #> [17] dbplyr_2.5.0                BiocGenerics_0.52.0         #> [19] BatchSVG_0.99.1             BiocStyle_2.34.0            #>  #> loaded via a namespace (and not attached): #>  [1] DBI_1.2.3               rlang_1.1.5             magrittr_2.0.3          #>  [4] compiler_4.4.2          RSQLite_2.3.9           png_0.1-8               #>  [7] systemfonts_1.2.1       vctrs_0.6.5             pkgconfig_2.0.3         #> [10] crayon_1.5.3            fastmap_1.2.0           magick_2.8.5            #> [13] XVector_0.46.0          labeling_0.4.3          rmarkdown_2.29          #> [16] UCSC.utils_1.2.0        ragg_1.3.3              purrr_1.0.4             #> [19] bit_4.5.0.1             xfun_0.51               zlibbioc_1.52.0         #> [22] cachem_1.1.0            beachmat_2.22.0         jsonlite_1.9.0          #> [25] blob_1.2.4              DelayedArray_0.32.0     BiocParallel_1.40.0     #> [28] irlba_2.3.5.1           parallel_4.4.2          R6_2.6.1                #> [31] bslib_0.9.0             RColorBrewer_1.1-3      jquerylib_0.1.4         #> [34] Rcpp_1.0.14             bookdown_0.42           knitr_1.49              #> [37] Matrix_1.7-1            tidyselect_1.2.1        abind_1.4-8             #> [40] yaml_2.3.10             codetools_0.2-20        curl_6.2.1              #> [43] lattice_0.22-6          scry_1.18.0             withr_3.0.2             #> [46] KEGGREST_1.46.0         evaluate_1.0.3          desc_1.4.3              #> [49] Biostrings_2.74.1       pillar_1.10.1           BiocManager_1.30.25     #> [52] filelock_1.0.3          generics_0.1.3          BiocVersion_3.20.0      #> [55] ggplot2_3.5.1           munsell_0.5.1           scales_1.3.0            #> [58] glue_1.8.0              tools_4.4.2             ScaledMatrix_1.14.0     #> [61] fs_1.6.5                cowplot_1.1.3           grid_4.4.2              #> [64] AnnotationDbi_1.68.0    colorspace_2.1-1        GenomeInfoDbData_1.2.13 #> [67] BiocSingular_1.22.0     cli_3.6.4               rsvd_1.0.5              #> [70] rappdirs_0.3.3          textshaping_1.0.0       S4Arrays_1.6.0          #> [73] gtable_0.3.6            sass_0.4.9              digest_0.6.37           #> [76] SparseArray_1.6.2       ggrepel_0.9.6           farver_2.1.2            #> [79] rjson_0.2.23            memoise_2.0.1           htmltools_0.5.8.1       #> [82] pkgdown_2.1.1           lifecycle_1.0.4         httr_1.4.7              #> [85] mime_0.12               bit64_4.6.0-1"},{"path":"https://christinehou11.github.io/BatchSVG/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Christine Hou. Author, maintainer. Jacqui Thompson. Author. Stephanie C. Hicks. Author.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hou C (2025). BatchSVG: Identify Batch-Biased Features Spatially Variable Genes. https://github.com/christinehou11/BatchSVGBatchSVG - R package version 0.99.1, http://www.bioconductor.org/packages/BatchSVG.","code":"@Manual{,   title = {BatchSVG: Identify Batch-Biased Features in Spatially Variable Genes},   author = {Christine Hou},   year = {2025},   url = {http://www.bioconductor.org/packages/BatchSVG},   note = {https://github.com/christinehou11/BatchSVGBatchSVG - R package version 0.99.1}, }"},{"path":"https://christinehou11.github.io/BatchSVG/index.html","id":"batchsvg","dir":"","previous_headings":"","what":"BatchSVG","title":"Identify Batch-Biased Features in Spatially Variable Genes","text":"BatchSVG feature-based Quality Control (QC) bias genes identification spatial transcriptomics snRNA-seq data types batch effect. BatchSVG method based binomial deviance model (Townes et al, 2019) applies cutoffs based standard deviation (SD) deviance rank difference metrics data-driven thresholding approach find batch-biased features.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/index.html","id":"installation","dir":"","previous_headings":"BatchSVG","what":"Installation","title":"Identify Batch-Biased Features in Spatially Variable Genes","text":"BatchSVG R package available Bioconductor version 3.19 later. can install BatchSVG using following commands R session Bioconductor. development version can obtained ","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {     install.packages(\"BiocManager\") }  BiocManager::install(\"BatchSVG\")  ## Check that you have a valid Bioconductor installation BiocManager::valid() BiocManager::install(\"christinehou11/BatchSVG\")"},{"path":"https://christinehou11.github.io/BatchSVG/index.html","id":"tutorial","dir":"","previous_headings":"BatchSVG","what":"Tutorial","title":"Identify Batch-Biased Features in Spatially Variable Genes","text":"detailed tutorial available Find Biased Features written Jacqui Thompson.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/index.html","id":"code-of-conduct","dir":"","previous_headings":"BatchSVG","what":"Code of Conduct","title":"Identify Batch-Biased Features in Spatially Variable Genes","text":"Please note BatchSVG project released Contributor Code Conduct. contributing project, agree abide terms.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/biasDetect.html","id":null,"dir":"Reference","previous_headings":"","what":"Biased Genes Identification — biasDetect","title":"Biased Genes Identification — biasDetect","text":"Function identify bias genes based user-selected threshold number standard deviation relative change deviance rank difference.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/biasDetect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Biased Genes Identification — biasDetect","text":"","code":"biasDetect(list_batch_df, threshold = \"both\", nSD_dev = NULL, nSD_rank = NULL)"},{"path":"https://christinehou11.github.io/BatchSVG/reference/biasDetect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Biased Genes Identification — biasDetect","text":"list_batch_df list : list data frame(s) generated featureSelection() function. length data frame list least one. threshold character string specifying filtering criterion. Must one : \"dev\": Filters genes based deviance threshold . \"rank\": Filters genes based rank threshold . \"\": Filters genes based either deviance rank threshold. Default \"\". nSD_dev integer: numeric vector specifying number standard deviation (nSD) batch analyzing relative change deviance. order values must correspond order batches list_batch_df. Required threshold \"dev\" \"\". single value provided, applied batches; otherwise, must length list_batch_df. nSD_rank vector: numeric vector specifying number standard deviation (nSD) batch analyzing rank differences. order values must correspond order batches list_batch_df. Required threshold \"rank\" \"\". single value provided, applied batches; otherwise, must length list_batch_df.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/biasDetect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Biased Genes Identification — biasDetect","text":"named list element corresponds batch contains: \"Plot\": diagnostic plot (either deviance, rank, ). \"Table\": filtered data frame containing outlier genes based specified threshold.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/biasDetect.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Biased Genes Identification — biasDetect","text":"","code":"data(\"spe_sub4\") #> Warning: data set ‘spe_sub4’ not found spe_sub4 #> Error: object 'spe_sub4' not found  data(\"svgs_sub4\") SVGs <- svgs_sub4$gene_id  list_batch_df <- featureSelect(input = spe_sub4,      batch_effects = c(\"sample_id\", \"sex\"), VGs = SVGs) #> Error: object 'spe_sub4' not found  biaGenes <- biasDetect(list_batch_df = list_batch_df, threshold = \"both\",      nSD_dev = c(5,4), nSD_rank = c(4,6)) #> Error: object 'list_batch_df' not found"},{"path":"https://christinehou11.github.io/BatchSVG/reference/featureSelect.html","id":null,"dir":"Reference","previous_headings":"","what":"Feature selection — featureSelect","title":"Feature selection — featureSelect","text":"function computes batch-adjusted deviance values, ranks genes accordingly, quantifies batch effects terms standard deviations mean difference. list follows order batch effects provided batch_effects.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/featureSelect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Feature selection — featureSelect","text":"","code":"featureSelect(input, batch_effects = NULL, VGs = NULL)"},{"path":"https://christinehou11.github.io/BatchSVG/reference/featureSelect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Feature selection — featureSelect","text":"input SpatialExperiment object containing spatial transcriptomics data.. batch_effects character vector specifying column names colData(input) indicate batch effects. Must match existing column names. VGs character vector specifying variable genes (VGs) analyzed. genes present vector retained feature selection.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/featureSelect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Feature selection — featureSelect","text":"named list element corresponds batch effect. batch contains data frame following columns: \"gene_id\": Gene identifier. \"gene_name\": Gene name. \"dev_default\": Deviance score without batch correction. \"dev_\": Deviance score batch correction. \"rank_default\": Rank gene based deviance without batch correction. \"rank_\": Rank gene based deviance batch correction. \"d_diff\": Relative change deviance default batch-corrected models. \"nSD_dev_\": number standard deviation relative change deviance batch. \"r_diff\": Rank difference default batch-corrected models. \"nSD_rank_\": number standard deviation rank difference batch.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/featureSelect.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Feature selection — featureSelect","text":"","code":"data(\"spe_sub4\") #> Warning: data set ‘spe_sub4’ not found spe_sub4 #> Error: object 'spe_sub4' not found  data(\"svgs_sub4\") SVGs <- svgs_sub4$gene_id  batch_df <- featureSelect(input = spe_sub4,      batch_effects = c(\"sample_id\", \"sex\"), VGs = SVGs) #> Error: object 'spe_sub4' not found"},{"path":"https://christinehou11.github.io/BatchSVG/reference/spe_sub4.html","id":null,"dir":"Reference","previous_headings":"","what":"Example SpatialExperiment Dataset for Batch Effect Analysis — spe_sub4","title":"Example SpatialExperiment Dataset for Batch Effect Analysis — spe_sub4","text":"spe_sub4 example SpatialExperiment object used demonstrate batch effect correction spatially variable gene (SVG) selection BatchSVG package. takes four samples (\"V11L05-333_B1\", \"V11L05-333_D1\",\"V11L05-335_D1\",\"V11L05-336_A1\") full spatial transcriptomics data stored humanHippocampus2024 data package.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/spe_sub4.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example SpatialExperiment Dataset for Batch Effect Analysis — spe_sub4","text":"","code":"data(\"svgs_sub4\")"},{"path":"https://christinehou11.github.io/BatchSVG/reference/spe_sub4.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example SpatialExperiment Dataset for Batch Effect Analysis — spe_sub4","text":"SpatialExperiment object : Dimensions 2082 genes (rows) × 18,945 spots (columns). Assays counts (raw gene expression) logcounts (log-transformed normalized counts). Row metadata (rowData) Includes gene annotations source, type, gene_search. Column metadata (colData) Includes 150 variables sample_id, in_tissue, nmf100. Reduced dimensions Contains PCA, t-SNE, UMAP embeddings labeled 10x_pca, 10x_tsne, 10x_umap. Spatial coordinates Available spatialCoords pixel row column positions. Image metadata Includes fields sample_id, image_id, scaleFactor.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/spe_sub4.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example SpatialExperiment Dataset for Batch Effect Analysis — spe_sub4","text":"Processed spatial transcriptomics data demonstration purposes.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/spe_sub4.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Example SpatialExperiment Dataset for Batch Effect Analysis — spe_sub4","text":"","code":"data(\"svgs_sub4\")"},{"path":"https://christinehou11.github.io/BatchSVG/reference/svg_nSD.html","id":null,"dir":"Reference","previous_headings":"","what":"SVGs Plots — svg_nSD","title":"SVGs Plots — svg_nSD","text":"function generates visualizations assess impact batch effects spatially variable genes (SVGs) analyzing changes deviance rank. function bins deviations normalized standard deviation (nSD) intervals creates histograms scatter plots illustrate distribution batch effects.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/svg_nSD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SVGs Plots — svg_nSD","text":"","code":"svg_nSD(list_batch_df, sd_interval_dev, sd_interval_rank)"},{"path":"https://christinehou11.github.io/BatchSVG/reference/svg_nSD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SVGs Plots — svg_nSD","text":"list_batch_df named list data frames, data frame corresponds batch effect contains columns deviance rank differences. sd_interval_dev numeric vector specifying interval widths standard deviation bins batch analyzing relative change deviance. order values must correspond order batches list_batch_df . single value provided, applied batches; otherwise, must length list_batch_df. sd_interval_rank vector: numeric vector specifying interval widths standard deviation bins analyzing rank differences. order values must correspond order batches list_batch_df. single value provided, applied batches; otherwise, must length list_batch_df.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/svg_nSD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SVGs Plots — svg_nSD","text":"combined ggplot object containing: Deviance Plots: Histogram deviance differences across SVGs, colored nSD intervals. Scatter plot comparing deviance values batch correction. Rank Plots: Histogram rank differences across SVGs, colored nSD intervals. Scatter plot comparing ranks batch correction. function arranges plots batch grid format easy comparison.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/svg_nSD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SVGs Plots — svg_nSD","text":"","code":"data(\"spe_sub4\") #> Warning: data set ‘spe_sub4’ not found spe_sub4 #> Error: object 'spe_sub4' not found  data(\"svgs_sub4\") SVGs <- svgs_sub4$gene_id  list_batch_df <- featureSelect(input = spe_sub4,      batch_effects = c(\"sample_id\", \"sex\"), VGs = SVGs) #> Error: object 'spe_sub4' not found  plots <- svg_nSD(list_batch_df = list_batch_df,      sd_interval_dev = c(5,4), sd_interval_rank = c(4,6)) #> Error: object 'list_batch_df' not found"},{"path":"https://christinehou11.github.io/BatchSVG/reference/svgs_sub4.html","id":null,"dir":"Reference","previous_headings":"","what":"Filtered Spatially Variable Genes (SVGs) Subset — svgs_sub4","title":"Filtered Spatially Variable Genes (SVGs) Subset — svgs_sub4","text":"svgs_sub4 subset spatially variable genes (SVGs) derived res_ranks dataset. includes genes ranked within top 2,000 least two selected samples original dataset.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/svgs_sub4.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filtered Spatially Variable Genes (SVGs) Subset — svgs_sub4","text":"","code":"data(\"svgs_sub4\")"},{"path":"https://christinehou11.github.io/BatchSVG/reference/svgs_sub4.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Filtered Spatially Variable Genes (SVGs) Subset — svgs_sub4","text":"data frame : gene_id Character. Ensembl Gene ID representing gene. n Integer. number selected samples gene ranked within top 2,000 spatially variable genes.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/svgs_sub4.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Filtered Spatially Variable Genes (SVGs) Subset — svgs_sub4","text":"Filtered subset res_ranks (ranked nnSVG() results).","code":""},{"path":"https://christinehou11.github.io/BatchSVG/reference/svgs_sub4.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filtered Spatially Variable Genes (SVGs) Subset — svgs_sub4","text":"","code":"data(\"svgs_sub4\")"},{"path":"https://christinehou11.github.io/BatchSVG/spe.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"NA","text":"BatchSVG R/Bioconductor package spatial transcriptomics data quality control (QC). feature-based QC method, package provides functions identify biased features associated batch effect(s) (e.g. sample, slide, sex) spatially variable genes (SVGs) using binomial deviance model, aiming develop downstream clustering performances remove technical noises caused batch effects. package works SpatialExperiment objects.","code":""},{"path":"https://christinehou11.github.io/BatchSVG/spe.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"NA","text":"(accepted Bioconductor). Install development version GitHub.","code":"if (!requireNamespace(\"BiocManager\")) {     install.packages(\"BiocManager\") } BiocManager::install(\"HuBMAPR\") remotes::install(\"christinehou11/BatchSVG\")"},{"path":"https://christinehou11.github.io/BatchSVG/spe.html","id":"biased-feature-identification","dir":"","previous_headings":"","what":"Biased Feature Identification","title":"NA","text":"section, include standard workflow using BatchSVG show method help detect visualize biased features SVGs.","code":"library(BatchSVG) # library(humanHippocampus2024) library(ExperimentHub) library(SpatialExperiment) library(SummarizedExperiment) library(tidyr) library(dplyr) library(tibble)"},{"path":"https://christinehou11.github.io/BatchSVG/spe.html","id":"data","dir":"","previous_headings":"Biased Feature Identification","what":"Data","title":"NA","text":"use spatially-resolved transcriptomics (SRT) dataset adjacent tissue sections anterior human hippocampus across ten adult neurotypical donors. dataset obtained humanHippocampus2024 package currently development version Bioconductor 3.21, spatialExperiment object generated processed spatial_HPC project. use spatially variable genes set generated spatial_HPC project. result generated nnSVG package. select four samples raw data example: V11L05-333_B1 V11L05-333_D1 V11L05-335_D1 V11L05-336_A1. refine selection include top 2,000 ranked features (rank≤\\leq 2000) genes appear one sample (n > 1). applying criteria, obtain 2,082 spatially variable genes across four samples.","code":"ehub <- ExperimentHub() spe <- ehub[[\"EH9605\"]] spe class: SpatialExperiment  dim: 31483 150917  metadata(1): Obtained_from assays(2): counts logcounts rownames(31483): MIR1302-2HG AL627309.1 ... AC007325.4 AC007325.2 rowData names(7): source type ... gene_type gene_search colnames(150917): AAACAACGAATAGTTC-1_V10B01-086_D1 AAACAAGTATCTCCCA-1_V10B01-086_D1 ...   TTGTTTCCATACAACT-1_Br2720_B1 TTGTTTGTATTACACG-1_Br2720_B1 colData names(150): sample_id in_tissue ... nmf99 nmf100 reducedDimNames(3): 10x_pca 10x_tsne 10x_umap mainExpName: NULL altExpNames(0): spatialCoords names(2) : pxl_col_in_fullres pxl_row_in_fullres imgData names(4): sample_id image_id data scaleFactor fix_order <- distinct(     as.data.frame(colData(spe)), slide, array, brnum, sample_id,      position, sex) %>%      arrange(slide, array) sub4 <- fix_order$sample_id[c(14,16, 20,21)]  spe_sub4 <- spe[,spe$sample_id %in% sub4] spe_sub4 # 31483, 18945 class: SpatialExperiment  dim: 31483 18945  metadata(1): Obtained_from assays(2): counts logcounts rownames(31483): MIR1302-2HG AL627309.1 ... AC007325.4 AC007325.2 rowData names(7): source type ... gene_type gene_search colnames(18945): AAACAACGAATAGTTC-1_V11L05-333_B1 AAACAAGTATCTCCCA-1_V11L05-333_B1 ...   TTGTTTGTATTACACG-1_V11L05-336_A1 TTGTTTGTGTAAATTC-1_V11L05-336_A1 colData names(150): sample_id in_tissue ... nmf99 nmf100 reducedDimNames(3): 10x_pca 10x_tsne 10x_umap mainExpName: NULL altExpNames(0): spatialCoords names(2) : pxl_col_in_fullres pxl_row_in_fullres imgData names(4): sample_id image_id data scaleFactor # res_ranks: SVGs results with rank values res_df_sub <- pivot_longer(     rownames_to_column(as.data.frame(res_ranks), var<-\"gene_id\"),          colnames(res_ranks),      names_to=\"sample_id\",      values_to=\"rank\",      values_drop_na=TRUE)      res_df_sub <- filter(res_df_sub,     sample_id %in%          c(\"V11L05-333_B1\", \"V11L05-333_D1\", \"V11L05-335_D1\", \"V11L05-336_A1\"),      rank <= 2000) # top 2k sig features      svgs_sub4 <- group_by(res_df_sub, gene_id) |>     tally() |>      filter(n>1) [1] 2082 nrow(svgs_sub4)"},{"path":"https://christinehou11.github.io/BatchSVG/spe.html","id":"perform-feature-selection-using-featureselect","dir":"","previous_headings":"Biased Feature Identification","what":"Perform Feature Selection using featureSelect()","title":"NA","text":"perform feature selection subset spatial transcriptomics data (input) using predefined set spatially variable genes (VGs). Specifically, compute number standard deviations relative change deviance (nSD_dev_{batch effect}) rank difference (nSD_rank_{batch effect}) adjusting batch effects. featureSelect() function enables feature selection accounting multiple batch effects. returns list data frames, batch effect associated corresponding data frame containing key results, including: Relative change deviance batch effect adjustment Rank differences batch-corrected uncorrected results Number standard deviations (nSD) relative change deviance rank difference use example applying featureSelect() four sample dataset adjusting batch effect sample_id sex.","code":"SVGs <- svgs_sub4$gene_id list_batch_df <- featureSelect(input = spe_sub4,      batch_effect = c(\"sample_id\", \"sex\"), VGs = SVGs) Running feature selection without batch... Batch Effect:sample_id Running feature selection without batch... Calculating deviance and rank difference... Batch Effect:sex Running feature selection without batch... Calculating deviance and rank difference... class(list_batch_df) [1] \"list\" head(list_batch_df$sample_id)           gene_id gene_name dev_default rank_default dev_sample_id rank_sample_id       d_diff 1 ENSG00000131584     ACAP3    16125.31         1262      15900.14           1269 0.0141612453 2 ENSG00000175756  AURKAIP1    17344.09         1060      17167.86           1058 0.0102651525 3 ENSG00000242485    MRPL20    17629.33         1023      17517.05           1004 0.0064098269 4 ENSG00000179403      VWA1    12860.93         1726      12825.66           1702 0.0027493688 5 ENSG00000160075     SSU72    16145.20         1255      16136.31           1220 0.0005506572 6 ENSG00000078369      GNB1    22402.83          516      22271.32            497 0.0059049925   nSD_dev_sample_id r_diff nSD_rank_sample_id 1       -0.09513109      7         0.16380252 2       -0.16945410     -2        -0.04680072 3       -0.24299943    -19        -0.44460683 4       -0.31282741    -24        -0.56160863 5       -0.35477067    -35        -0.81901258 6       -0.25262980    -19        -0.44460683 head(list_batch_df$sex)           gene_id gene_name dev_default rank_default  dev_sex rank_sex       d_diff nSD_dev_sex 1 ENSG00000131584     ACAP3    16125.31         1262 16118.48     1250 4.234208e-04  -0.2615600 2 ENSG00000175756  AURKAIP1    17344.09         1060 17247.44     1064 5.603690e-03  -0.1013769 3 ENSG00000242485    MRPL20    17629.33         1023 17585.70     1013 2.480783e-03  -0.1979427 4 ENSG00000179403      VWA1    12860.93         1726 12860.90     1709 1.811106e-06  -0.2745969 5 ENSG00000160075     SSU72    16145.20         1255 16141.12     1243 2.527558e-04  -0.2668373 6 ENSG00000078369      GNB1    22402.83          516 22314.17      509 3.973515e-03  -0.1517848   r_diff nSD_rank_sex 1    -12   -0.3080188 2      4    0.1026729 3    -10   -0.2566824 4    -17   -0.4363600 5    -12   -0.3080188 6     -7   -0.1796776"},{"path":"https://christinehou11.github.io/BatchSVG/spe.html","id":"visualize-svg-selection-using-svg_nsd-for-batch-effects","dir":"","previous_headings":"Biased Feature Identification","what":"Visualize SVG Selection Using svg_nSD for Batch Effects","title":"NA","text":"svg_nSD() function generates visualizations assess batch effects spatially variable genes (SVGs). produces bar charts showing distribution SVGs based relative change deviance rank difference, colors representing different nSD intervals. Additionally, scatter plots compare deviance rank values without batch effects. interpreting plots, can determine appropriate nSD thresholds filtering biased features. left panels illustrate distribution SVGs terms deviance rank difference, right panels compare values accounting batch effects. can also apply svg_nSD() single batch effect. Note function requires input list data frames, even analyzing one batch.","code":"plots <- svg_nSD(list_batch_df = list_batch_df,                  sd_interval_dev = c(5,4), sd_interval_rank = c(4,6)) plots$sample_id plots$sex plots <- svg_nSD(list_batch_df = list_batch_df[1],                  sd_interval_dev = 5, sd_interval_rank = 7) plots$sample_id"},{"path":"https://christinehou11.github.io/BatchSVG/spe.html","id":"identify-biased-genes-using-biasdetect","dir":"","previous_headings":"Biased Feature Identification","what":"Identify Biased Genes Using biasDetect()","title":"NA","text":"function biasDetect() designed identify filter biased genes across different batch effects. Using threshold values selected visualization results generated svg_nSD(), function systematically detects outliers exceed specified normalized standard deviation (nSD) threshold either relative deviance change, rank difference, . function outputs visualizations comparing deviance rank values without batch effects. Genes high deviations, highlighted color, identified potentially biased can excluded based selected nSD thresholds. use nSD_dev = 7 nSD_rank = 6 example. user adjust value based dataset features. Usage Different Threshold Options threshold = \"dev\": Filters biased genes based relative change deviance. Genes deviance changes exceeding specified nSD_dev threshold identified batch-affected can removed. threshold = \"rank\": Identifies biased genes based solely rank difference. Genes rank shifts exceeding nSD_rank considered biased.","code":"bias_dev <- biasDetect(list_batch_df = list_batch_df,                          threshold = \"dev\", nSD_dev = 7) head(bias_dev$sample_id$Table)           gene_id gene_name dev_default rank_default dev_sample_id rank_sample_id    d_diff 1 ENSG00000174576     NPAS4    35003.31          125     24629.414            363 0.4211996 2 ENSG00000123358     NR4A1    23299.81          457     16115.928           1226 0.4457631 3 ENSG00000170345       FOS    42305.65           73     27146.089            263 0.5584435 4 ENSG00000256618  MTRNR2L1    69206.34           28     24876.086            351 1.7820430 5 ENSG00000118271       TTR  4719046.58            1   3292127.945              1 0.4334335 6 ENSG00000229807      XIST    15223.50         1408      8819.689           2050 0.7260812   nSD_dev_sample_id r_diff nSD_rank_sample_id nSD_bin_dev dev_outlier 1          7.669653    238           5.569286      [7,14)        TRUE 2          8.138234    769          17.994876      [7,14)        TRUE 3         10.287758    190           4.446068      [7,14)        TRUE 4         33.629502    323           7.558316     [28,35]        TRUE 5          7.903030      0           0.000000      [7,14)        TRUE 6         13.485664    642          15.023031      [7,14)        TRUE bias_dev$sample_id$Plot"},{"path":"https://christinehou11.github.io/BatchSVG/news/index.html","id":"batchsvg-0991","dir":"Changelog","previous_headings":"","what":"BatchSVG 0.99.1","title":"BatchSVG 0.99.1","text":"Added NEWS.md file track changes package. First full version package submitted Bioconductor.","code":""}]
